<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <data noupdate="0">

        <!-- Model Sale Teams -->
        <record model="ir.module.category" id="nca_access_module_category">
            <field name="name">NCA Access rights</field>
            <field name="description">Access group for NCA manage</field>
        </record>
		
		<record id="nca_group_sale_team_member" model="res.groups">
            <field name="name">Sale Team member</field>
            <field name="category_id" ref="nca_access_module_category"/>
            <field name="implied_ids" eval="[(4, ref('base.group_user')),(4,ref('sales_team.group_sale_salesman')),(4,ref('product.group_sale_pricelist'))]"/>
            <field name="comment">the user will have access to his own data.</field>
        </record>

        <record id="nca_group_sale_team_leader" model="res.groups">
            <field name="name">Sale Team leader</field>
            <field name="category_id" ref="nca_access_module_category"/>
            <field name="implied_ids" eval="[(4, ref('base.group_user')),(4,ref('sales_team.group_sale_salesman')),(4,ref('nca_group_sale_team_member'))]"/>
            <field name="comment">the user will have access to his team data.</field>
        </record>

        <record id="nca_rule_crm_team_leader" model="ir.rule">
            <field name="name">nca.crm.team.leader</field>
            <field name="model_id" ref="model_crm_team"/>
            <field name="domain_force">
                ['|',('member_ids','in',user.id),('id','child_of',user.sale_team_id.id)]
            </field>
            <field name="groups" eval="[(4,ref('nca_group_sale_team_leader'))]"/>
        </record>

        <record id="nca_rule_crm_team_member" model="ir.rule">
            <field name="name">nca.crm.team.member</field>
            <field name="model_id" ref="model_crm_team"/>
            <field name="domain_force">
                [('member_ids','in',user.id)]
            </field>
            <field name="groups" eval="[(4,ref('nca_group_sale_team_member'))]"/>
        </record>

        <!-- Model Sale Order & Orderline -->
        <record id="nca_rule_sale_order_team_leader" model="ir.rule">
            <field name="name">nca.sale.order.leader</field>
            <field name="model_id" ref="portal_sale.model_sale_order"/>
            <field name="domain_force">
                ['|',('team_id','=',user.sale_team_id.id),('team_id','child_of',user.sale_team_id.id)]
            </field>
            <field name="groups" eval="[(4,ref('nca_group_sale_team_leader'))]"/>
        </record>

        <record id="sales_team.menu_sale_report" model="ir.ui.menu">
            <field name="groups_id" eval="[(4,ref('nca_group_sale_team_leader'))]"/>
        </record>

        <record id="nca_rule_sale_order_line_team_leader" model="ir.rule">
            <field name="name">nca.sale.order.line.leader</field>
            <field name="model_id" ref="sale.model_sale_order_line"/>
            <field name="domain_force">
                [('order_id.team_id','=',user.sale_team_id.id)]
            </field>
            <field name="groups" eval="[(4,ref('nca_group_sale_team_leader'))]"/>
        </record>

        <!-- Model Sale Pricelist & Pricelist item -->
		<record id="nca_rule_pricelist_member" model="ir.rule">
            <field name="name">nca.pricelist.member</field>
            <field name="model_id" ref="model_product_pricelist"/>
            <field name="domain_force">
                [('team_id','=',user.sale_team_id.id)]
            </field>
            <field name="groups" eval="[(4,ref('nca_group_sale_team_member'))]"/>
        </record>

        <record id="nca_rule_pricelist_item_member" model="ir.rule">
            <field name="name">nca.pricelist.item.member</field>
            <field name="model_id" ref="product.model_product_pricelist_item"/>
            <field name="domain_force">
                [('pricelist_id.team_id','=',user.sale_team_id.id)]
            </field>
			<field name="groups" eval="[(4,ref('nca_group_sale_team_member'))]"/>
        </record>

        <!-- Model Res Partner -->

	<!-- Sale leader see Sale Team Configuration -->
        <record id="sales_team.menu_sale_config" model="ir.ui.menu">
            <field name="groups_id" eval="[(4,ref('group_sale_teamleader'))]"/>
        </record>

    </data>

</odoo>
