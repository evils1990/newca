<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <data noupdate="0">

        <!-- Model Sale Teams -->
        <record model="ir.module.category" id="nca_access_module_category">
            <field name="name">NCA Access rights</field>
            <field name="description">Access group for NCA manage</field>
        </record>

        <record id="group_sale_teamleader" model="res.groups">
            <field name="name">User: Team leader</field>
            <field name="category_id" ref="nca_access_module_category"/>
            <field name="implied_ids" eval="[(4, ref('base.group_user')),(4,ref('sales_team.group_sale_salesman'))]"/>
            <field name="comment">the user will have access to his team data.</field>
        </record>

        <record id="rule_access_team_leader" model="ir.rule">
            <field name="name">crm.team.leader</field>
            <field name="model_id" ref="model_crm_team"/>
            <field name="domain_force">
                ['|',('user_id','=',user.id),'|',('member_ids','in',user.id),('id','child_of',user.sale_team_id.id)]
            </field>
            <field name="groups" eval="[(4,ref('group_sale_teamleader'))]"/>
        </record>

        <record id="sales_team.crm_rule_own_salesteam" model="ir.rule">
             <field name="model_id" ref="model_crm_team"/>
            <field name="domain_force">
                [('member_ids','in',user.id)]
            </field>
            <field name="groups" eval="[(4,ref('sales_team.group_sale_salesman'))]"/>
        </record>

        <!-- Model Sale Order & Orderline -->
        <record id="nca_sale_order_team_leader_rule" model="ir.rule">
            <field name="name">nca.sale.order.leader</field>
            <field name="model_id" ref="portal_sale.model_sale_order"/>
            <field name="domain_force">
                ['|',('team_id','=',user.sale_team_id.id),('team_id','child_of',user.sale_team_id.id)]
            </field>
            <field name="groups" eval="[(4,ref('group_sale_teamleader'))]"/>
            <field name="term_unlink">0</field>
        </record>
		
		<record id="nca_sale_order_line_team_leader_rule" model="ir.rule">
            <field name="name">nca.sale.order.line.leader</field>
            <field name="model_id" ref="sale.model_sale_order_line"/>
            <field name="domain_force">
                [('order_id.team_id','=',user.sale_team_id.id)]
            </field>
            <field name="groups" eval="[(4,ref('group_sale_teamleader'))]"/>
            <field name="term_unlink">0</field>
        </record>

        <record id="nca_sale_orer_line_member_rule" model="ir.rule">
            <field name="name">nca.sale.order.line.user</field>
            <field name="model_id" ref="sale.model_sale_order_line"/>
            <field name="domain_force">
                [('create_uid','=',user.id)]
            </field>
            <field name="groups" eval="[(4, ref('sales_team.group_sale_salesman'))]"/>
        </record>

        <!-- Model Sale Pricelist & Pricelist item -->
		<record id="nca_price_list_leader_rule" model="ir.rule">
            <field name="name">nca.price.list.leader</field>
            <field name="model_id" ref="sale_agency.model_product_pricelist"/>
            <field name="domain_force">
                [('team_id','=',user.sale_team_id.id)]
            </field>
            <field name="groups" eval="[(4,ref('group_sale_teamleader'))]"/>
        </record>

        <record id="nca_price_list_user_rule" model="ir.rule">
            <field name="name">nca.price.list.user</field>
            <field name="model_id" ref="sale_agency.model_product_pricelist"/>
            <field name="domain_force">
                [('team_id','=',user.sale_team_id.id)]
            </field>
            <field name="groups" eval="[(4, ref('sales_team.group_sale_salesman'))]"/>
        </record>

        <!-- Model Res Partner -->

	<!-- Sale leader see Sale Team Configuration -->
        <record id="sales_team.menu_sale_config" model="ir.ui.menu">
            <field name="groups_id" eval="[(4,ref('group_sale_teamleader'))]"/>
        </record>

    </data>

</odoo>
